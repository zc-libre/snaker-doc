(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{567:function(t,s,a){"use strict";a.r(s);var e=a(9),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h3",{attrs:{id:"流程定义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#流程定义"}},[t._v("#")]),t._v(" 流程定义")]),t._v(" "),a("p",[t._v("流程定义服务作为工作流平台中最频繁调用的服务，并且流程定义是业务流程的静态逻辑数据，所以一般使用缓存，以减少数据库io访问次数。")]),t._v(" "),a("p",[t._v("snaker在设计流程定义服务时，通过实现缓存管理器包装接口来实现流程定义的缓存。默认使用"),a("code",[t._v("内存缓存")]),t._v("方式，同时也支持"),a("code",[t._v("ehcache")]),t._v("缓存框架。只需要依赖"),a("code",[t._v("snaker-ehcache")]),t._v("包即可。")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("snaker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),t._v("IProcessService")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("snaker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),t._v("CacheManagerAware")]),t._v("\n")])])]),a("ul",[a("li",[a("code",[t._v("发布")])]),t._v(" "),a("li",[a("code",[t._v("重新发布")])]),t._v(" "),a("li",[a("code",[t._v("卸载")])]),t._v(" "),a("li",[a("code",[t._v("更新类别")])]),t._v(" "),a("li",[a("code",[t._v("查询接口")])])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("快速入门章节的流程定义已经介绍如何通过设计器创建新的流程，本章节主要介绍对已经创建好的流程定义，如何操作。\n")])])]),a("p",[t._v("流程发布统一使用"),a("code",[t._v("InputStream")]),t._v("输入流作为流程定义的数据。可借助")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("org.snaker.engine.helper.StreamHelper\n")])])]),a("p",[t._v("流帮助类完成，方法如下定义：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[a("code",[t._v("InputStream的方法名称")])]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[a("code",[t._v("描述")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("getStreamFromString")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据字符串获取输入流")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("getStreamFromFile")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据文件对象获取输入流")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("getStreamFromClasspath")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据类路径下的资源文件名称获取输入流")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("getStreamFromUrl")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("根据url远程资源获取输入流")])])])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("注意：snaker的流程定义编码格式统一使用UTF-8\n")])])]),a("h3",{attrs:{id:"发布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#发布"}},[t._v("#")]),t._v(" "),a("code",[t._v("发布")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("deploy(InputStream inputStream)")])])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('engine.process().deploy(StreamHelper\n    .getStreamFromClasspath("flows/leave.snaker")\n')])])]),a("p",[t._v("发布后的版本号默认为0，如果存在同名的流程定义，则新的流程定义版本号依次加1，并不会影响其它已经运行的流程实例。")]),t._v(" "),a("h3",{attrs:{id:"重新发布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重新发布"}},[t._v("#")]),t._v(" "),a("code",[t._v("重新发布")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("redeploy(String processId, InputStream inputStream)")])])]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[t._v("engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("process")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("redeploy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("processId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StreamHelper")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getStreamFromClasspath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"flows/leave.snaker"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("重新发布流程会影响已经运行的流程实例")]),t._v(" "),a("h3",{attrs:{id:"卸载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#卸载"}},[t._v("#")]),t._v(" "),a("code",[t._v("卸载")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("undeploy(String processId)")])])]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[t._v("engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("process")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("undeploy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("processId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("卸载流程只会更新状态state值，不会删除物理数据")]),t._v(" "),a("h3",{attrs:{id:"更新类别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更新类别"}},[t._v("#")]),t._v(" "),a("code",[t._v("更新类别")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("updateType(String processId, String type)")])])]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[t._v("engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("process")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("processId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("更新类别主要用于业务流程较多，并且存在分类情况时使用")]),t._v(" "),a("h3",{attrs:{id:"查询接口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询接口"}},[t._v("#")]),t._v(" "),a("code",[t._v("查询接口")])]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Process")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getProcessById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Process")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getProcessByName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Process")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getProcessByVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" version"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Process")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getProcesss")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("QueryFilter")]),t._v(" filter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Process")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getProcesss")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Page")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Process")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("QueryFilter")]),t._v(" filter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);